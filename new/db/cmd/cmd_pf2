NAME=PE JSON test
FILE=../bins/pe/ch22.exe
EXPECT64=W3sibmFtZSI6InNpZ25hdHVyZSIsInR5cGUiOiJ6Iiwib2Zmc2V0IjoxMjgsInZhbHVlIjoxMjgsInN0cmluZyI6IlBFIn0seyJuYW1lIjoiZmlsZUhlYWRlciIsInR5cGUiOiJwZV9pbWFnZV9maWxlX2hlYWRlciIsIm9mZnNldCI6MTMyLCJ2YWx1ZSI6W3sibmFtZSI6Im1hY2hpbmUiLCJ0eXBlIjoiRSIsIm9mZnNldCI6MTMyLCJ2YWx1ZSI6InBlX21hY2hpbmUifSx7Im5hbWUiOiJudW1iZXJPZlNlY3Rpb25zIiwidHlwZSI6InciLCJvZmZzZXQiOjEzNCwidmFsdWUiOjR9LHsibmFtZSI6InRpbWVEYXRlU3RhbXAiLCJ0eXBlIjoidCIsIm9mZnNldCI6MTM2LCJ2YWx1ZSI6IlRodSBTZXAgMTEgMTg6MjE6NDYgMjAxNCJ9LHsibmFtZSI6InBvaW50ZXJUb1N5bWJvbFRhYmxlIiwidHlwZSI6IngiLCJvZmZzZXQiOjE0MCwidmFsdWUiOjB9LHsibmFtZSI6Im51bWJlck9mU3ltYm9scyIsInR5cGUiOiJ4Iiwib2Zmc2V0IjoxNDQsInZhbHVlIjowfSx7Im5hbWUiOiJzaXplT2ZPcHRpb25hbEhlYWRlciIsInR5cGUiOiJ3Iiwib2Zmc2V0IjoxNDgsInZhbHVlIjoyMjR9LHsibmFtZSI6ImNoYXJhY3RlcmlzdGljcyIsInR5cGUiOiJCIiwib2Zmc2V0IjoxNTAsInZhbHVlIjoiMHgwMDAwMDEwMiA6IElNQUdFX0ZJTEVfRVhFQ1VUQUJMRV9JTUFHRSB8IElNQUdFX0ZJTEVfMzJCSVRfTUFDSElORSJ9XX0seyJuYW1lIjoib3B0aW9uYWxIZWFkZXIiLCJ0eXBlIjoicGVfaW1hZ2Vfb3B0aW9uYWxfaGVhZGVyMzIiLCJvZmZzZXQiOjE1MiwidmFsdWUiOlt7Im5hbWUiOiJtYWdpYyIsInR5cGUiOiJFIiwib2Zmc2V0IjoxNTIsInZhbHVlIjoicGVfbWFnaWMifSx7Im5hbWUiOiJtYWpvckxpbmtlclZlcnNpb24iLCJ0eXBlIjoiYiIsIm9mZnNldCI6MTU0LCJ2YWx1ZSI6MTF9LHsibmFtZSI6Im1pbm9yTGlua2VyVmVyc2lvbiIsInR5cGUiOiJiIiwib2Zmc2V0IjoxNTUsInZhbHVlIjowfSx7Im5hbWUiOiJzaXplT2ZDb2RlIiwidHlwZSI6IngiLCJvZmZzZXQiOjE1NiwidmFsdWUiOjEyMjg4fSx7Im5hbWUiOiJzaXplT2ZJbml0aWFsaXplZERhdGEiLCJ0eXBlIjoieCIsIm9mZnNldCI6MTYwLCJ2YWx1ZSI6MTMzMTJ9LHsibmFtZSI6InNpemVPZlVuaW5pdGlhbGl6ZWREYXRhIiwidHlwZSI6IngiLCJvZmZzZXQiOjE2NCwidmFsdWUiOjB9LHsibmFtZSI6ImFkZHJlc3NPZkVudHJ5UG9pbnQiLCJ0eXBlIjoieCIsIm9mZnNldCI6MTY4LCJ2YWx1ZSI6MjAyODZ9LHsibmFtZSI6ImJhc2VPZkNvZGUiLCJ0eXBlIjoieCIsIm9mZnNldCI6MTcyLCJ2YWx1ZSI6ODE5Mn0seyJuYW1lIjoiYmFzZU9mRGF0YSIsInR5cGUiOiJ4Iiwib2Zmc2V0IjoxNzYsInZhbHVlIjoyNDU3Nn0seyJuYW1lIjoiaW1hZ2VCYXNlIiwidHlwZSI6IngiLCJvZmZzZXQiOjE4MCwidmFsdWUiOjQxOTQzMDR9LHsibmFtZSI6InNlY3Rpb25BbGlnbm1lbnQiLCJ0eXBlIjoieCIsIm9mZnNldCI6MTg0LCJ2YWx1ZSI6ODE5Mn0seyJuYW1lIjoiZmlsZUFsaWdubWVudCIsInR5cGUiOiJ4Iiwib2Zmc2V0IjoxODgsInZhbHVlIjo1MTJ9LHsibmFtZSI6Im1ham9yT3BlcmF0aW5nU3lzdGVtVmVyc2lvbiIsInR5cGUiOiJ3Iiwib2Zmc2V0IjoxOTIsInZhbHVlIjo0fSx7Im5hbWUiOiJtaW5vck9wZXJhdGluZ1N5c3RlbVZlcnNpb24iLCJ0eXBlIjoidyIsIm9mZnNldCI6MTk0LCJ2YWx1ZSI6MH0seyJuYW1lIjoibWFqb3JJbWFnZVZlcnNpb24iLCJ0eXBlIjoidyIsIm9mZnNldCI6MTk2LCJ2YWx1ZSI6MH0seyJuYW1lIjoibWlub3JJbWFnZVZlcnNpb24iLCJ0eXBlIjoidyIsIm9mZnNldCI6MTk4LCJ2YWx1ZSI6MH0seyJuYW1lIjoibWFqb3JTdWJzeXN0ZW1WZXJzaW9uIiwidHlwZSI6InciLCJvZmZzZXQiOjIwMCwidmFsdWUiOjZ9LHsibmFtZSI6Im1pbm9yU3Vic3lzdGVtVmVyc2lvbiIsInR5cGUiOiJ3Iiwib2Zmc2V0IjoyMDIsInZhbHVlIjowfSx7Im5hbWUiOiJ3aW4zMlZlcnNpb25WYWx1ZSIsInR5cGUiOiJ4Iiwib2Zmc2V0IjoyMDQsInZhbHVlIjowfSx7Im5hbWUiOiJzaXplT2ZJbWFnZSIsInR5cGUiOiJ4Iiwib2Zmc2V0IjoyMDgsInZhbHVlIjo1NzM0NH0seyJuYW1lIjoic2l6ZU9mSGVhZGVycyIsInR5cGUiOiJ4Iiwib2Zmc2V0IjoyMTIsInZhbHVlIjoxMDI0fSx7Im5hbWUiOiJjaGVja1N1bSIsInR5cGUiOiJ4Iiwib2Zmc2V0IjoyMTYsInZhbHVlIjowfSx7Im5hbWUiOiJzdWJzeXN0ZW0iLCJ0eXBlIjoiRSIsIm9mZnNldCI6MjIwLCJ2YWx1ZSI6InBlX3N1YnN5c3RlbSJ9LHsibmFtZSI6ImRsbENoYXJhY3RlcmlzdGljcyIsInR5cGUiOiJCIiwib2Zmc2V0IjoyMjIsInZhbHVlIjoiMHgwMDAwODU2MCA6IElNQUdFX0RMTENIQVJBQ1RFUklTVElDU19ISUdIX0VOVFJPUFlfVkEgfCBJTUFHRV9ETExDSEFSQUNURVJJU1RJQ1NfRFlOQU1JQ19CQVNFIHwgSU1BR0VfRExMQ0hBUkFDVEVSSVNUSUNTX05YX0NPTVBBVCB8IElNQUdFX0RMTENIQVJBQ1RFUklTVElDU19OT19TRUggfCBJTUFHRV9ETExDSEFSQUNURVJJU1RJQ1NfVEVSTUlOQUxfU0VSVkVSX0FXQVJFIn0seyJuYW1lIjoic2l6ZU9mU3RhY2tSZXNlcnZlIiwidHlwZSI6IngiLCJvZmZzZXQiOjIyNCwidmFsdWUiOjEwNDg1NzZ9LHsibmFtZSI6InNpemVPZlN0YWNrQ29tbWl0IiwidHlwZSI6IngiLCJvZmZzZXQiOjIyOCwidmFsdWUiOjQwOTZ9LHsibmFtZSI6InNpemVPZkhlYXBSZXNlcnZlIiwidHlwZSI6IngiLCJvZmZzZXQiOjIzMiwidmFsdWUiOjEwNDg1NzZ9LHsibmFtZSI6InNpemVPZkhlYXBDb21taXQiLCJ0eXBlIjoieCIsIm9mZnNldCI6MjM2LCJ2YWx1ZSI6NDA5Nn0seyJuYW1lIjoibG9hZGVyRmxhZ3MiLCJ0eXBlIjoieCIsIm9mZnNldCI6MjQwLCJ2YWx1ZSI6MH0seyJuYW1lIjoibnVtYmVyT2ZSdmFBbmRTaXplcyIsInR5cGUiOiJ4Iiwib2Zmc2V0IjoyNDQsInZhbHVlIjoxNn0seyJuYW1lIjoiZGF0YURpcmVjdG9yeSIsInR5cGUiOiJwZV9pbWFnZV9kYXRhX2RpcmVjdG9yeSIsIm9mZnNldCI6MjQ4LCJ2YWx1ZSI6W1sKeyJuYW1lIjoidmlydHVhbEFkZHJlc3MiLCJ0eXBlIjoieCIsIm9mZnNldCI6MjQ4LCJ2YWx1ZSI6MH0seyJuYW1lIjoic2l6ZSIsInR5cGUiOiJ4Iiwib2Zmc2V0IjoyNTIsInZhbHVlIjowfSx7Im5hbWUiOiJ2aXJ0dWFsQWRkcmVzcyIsInR5cGUiOiJ4Iiwib2Zmc2V0IjoyNTYsInZhbHVlIjoyMDIwOH0seyJuYW1lIjoic2l6ZSIsInR5cGUiOiJ4Iiwib2Zmc2V0IjoyNjAsInZhbHVlIjo3NX0seyJuYW1lIjoidmlydHVhbEFkZHJlc3MiLCJ0eXBlIjoieCIsIm9mZnNldCI6MjY0LCJ2YWx1ZSI6MzI3Njh9LHsibmFtZSI6InNpemUiLCJ0eXBlIjoieCIsIm9mZnNldCI6MjY4LCJ2YWx1ZSI6MTE4NDB9LHsibmFtZSI6InZpcnR1YWxBZGRyZXNzIiwidHlwZSI6IngiLCJvZmZzZXQiOjI3MiwidmFsdWUiOjB9LHsibmFtZSI6InNpemUiLCJ0eXBlIjoieCIsIm9mZnNldCI6Mjc2LCJ2YWx1ZSI6MH0seyJuYW1lIjoidmlydHVhbEFkZHJlc3MiLCJ0eXBlIjoieCIsIm9mZnNldCI6MjgwLCJ2YWx1ZSI6MH0seyJuYW1lIjoic2l6ZSIsInR5cGUiOiJ4Iiwib2Zmc2V0IjoyODQsInZhbHVlIjowfSx7Im5hbWUiOiJ2aXJ0dWFsQWRkcmVzcyIsInR5cGUiOiJ4Iiwib2Zmc2V0IjoyODgsInZhbHVlIjo0OTE1Mn0seyJuYW1lIjoic2l6ZSIsInR5cGUiOiJ4Iiwib2Zmc2V0IjoyOTIsInZhbHVlIjoxMn0seyJuYW1lIjoidmlydHVhbEFkZHJlc3MiLCJ0eXBlIjoieCIsIm9mZnNldCI6Mjk2LCJ2YWx1ZSI6MjQ1NzZ9LHsibmFtZSI6InNpemUiLCJ0eXBlIjoieCIsIm9mZnNldCI6MzAwLCJ2YWx1ZSI6Mjh9LHsibmFtZSI6InZpcnR1YWxBZGRyZXNzIiwidHlwZSI6IngiLCJvZmZzZXQiOjMwNCwidmFsdWUiOjB9LHsibmFtZSI6InNpemUiLCJ0eXBlIjoieCIsIm9mZnNldCI6MzA4LCJ2YWx1ZSI6MH0seyJuYW1lIjoidmlydHVhbEFkZHJlc3MiLCJ0eXBlIjoieCIsIm9mZnNldCI6MzEyLCJ2YWx1ZSI6MH0seyJuYW1lIjoic2l6ZSIsInR5cGUiOiJ4Iiwib2Zmc2V0IjozMTYsInZhbHVlIjowfSx7Im5hbWUiOiJ2aXJ0dWFsQWRkcmVzcyIsInR5cGUiOiJ4Iiwib2Zmc2V0IjozMjAsInZhbHVlIjowfSx7Im5hbWUiOiJzaXplIiwidHlwZSI6IngiLCJvZmZzZXQiOjMyNCwidmFsdWUiOjB9LHsibmFtZSI6InZpcnR1YWxBZGRyZXNzIiwidHlwZSI6IngiLCJvZmZzZXQiOjMyOCwidmFsdWUiOjB9LHsibmFtZSI6InNpemUiLCJ0eXBlIjoieCIsIm9mZnNldCI6MzMyLCJ2YWx1ZSI6MH0seyJuYW1lIjoidmlydHVhbEFkZHJlc3MiLCJ0eXBlIjoieCIsIm9mZnNldCI6MzM2LCJ2YWx1ZSI6MH0seyJuYW1lIjoic2l6ZSIsInR5cGUiOiJ4Iiwib2Zmc2V0IjozNDAsInZhbHVlIjowfSx7Im5hbWUiOiJ2aXJ0dWFsQWRkcmVzcyIsInR5cGUiOiJ4Iiwib2Zmc2V0IjozNDQsInZhbHVlIjo4MTkyfSx7Im5hbWUiOiJzaXplIiwidHlwZSI6IngiLCJvZmZzZXQiOjM0OCwidmFsdWUiOjh9LHsibmFtZSI6InZpcnR1YWxBZGRyZXNzIiwidHlwZSI6IngiLCJvZmZzZXQiOjM1MiwidmFsdWUiOjB9LHsibmFtZSI6InNpemUiLCJ0eXBlIjoieCIsIm9mZnNldCI6MzU2LCJ2YWx1ZSI6MH0seyJuYW1lIjoidmlydHVhbEFkZHJlc3MiLCJ0eXBlIjoieCIsIm9mZnNldCI6MzYwLCJ2YWx1ZSI6ODIwMH0seyJuYW1lIjoic2l6ZSIsInR5cGUiOiJ4Iiwib2Zmc2V0IjozNjQsInZhbHVlIjo3Mn0seyJuYW1lIjoidmlydHVhbEFkZHJlc3MiLCJ0eXBlIjoieCIsIm9mZnNldCI6MzY4LCJ2YWx1ZSI6MH0seyJuYW1lIjoic2l6ZSIsInR5cGUiOiJ4Iiwib2Zmc2V0IjozNzIsInZhbHVlIjowfV0KXX1dfV0KCg==
ARGS=-nn
CMDS64=ZSBhc20uYml0cz0zMgpzIDB4ODAKcGZqLnBlX250X2ltYWdlX2hlYWRlcnMzMgoK
RUN
NAME=JSON output
FILE=malloc://1024
EXPECT64=W1t7ImluZGV4IjowLCJvZmZzZXQiOjB9LHsibmFtZSI6ImJsYWgiLCJ0eXBlIjoidyIsIm9mZnNldCI6MCwidmFsdWUiOjQ2NjB9LHsibmFtZSI6Im1laCIsInR5cGUiOiJ3Iiwib2Zmc2V0IjoyLCJ2YWx1ZSI6MjY1MDV9LHsibmFtZSI6IkJ1aCIsInR5cGUiOiJwbG9wIiwib2Zmc2V0Ijo0LCJ2YWx1ZSI6W3sibmFtZSI6ImZpcnN0IiwidHlwZSI6ImkiLCJvZmZzZXQiOjQsInZhbHVlIjo2NjZ9LHsibmFtZSI6IkJvaCIsInR5cGUiOiJ0cm9sbCIsIm9mZnNldCI6OCwidmFsdWUiOlt7Im5hbWUiOiJpbnRlZ2VyIiwidHlwZSI6ImkiLCJvZmZzZXQiOjgsInZhbHVlIjo0MDAwfSx7Im5hbWUiOiJ3b3JkIiwidHlwZSI6InciLCJvZmZzZXQiOjEyLCJ2YWx1ZSI6NDJ9LHsibmFtZSI6IkJhaCIsInR5cGUiOiJ0cm9sbCoiLCJvZmZzZXQiOjE0LCJ2YWx1ZSI6NDh9LHsibmFtZSI6ImludGVnZXIiLCJ0eXBlIjoiaSIsIm9mZnNldCI6NDgsInZhbHVlIjoyMH0seyJuYW1lIjoid29yZCIsInR5cGUiOiJ3Iiwib2Zmc2V0Ijo1MiwidmFsdWUiOjU3MzJ9LHsibmFtZSI6IkJhaCIsInR5cGUiOiJ0cm9sbCoiLCJvZmZzZXQiOjU0LCJ2YWx1ZSI6MzJ9LHsibmFtZSI6ImludGVnZXIiLCJ0eXBlIjoiaSIsIm9mZnNldCI6MzIsInZhbHVlIjoxNjY0fSx7Im5hbWUiOiJ3b3JkIiwidHlwZSI6InciLCJvZmZzZXQiOjM2LCJ2YWx1ZSI6MTYzODR9LHsibmFtZSI6IkJhaCIsInR5cGUiOiJ0cm9sbCoiLCJvZmZzZXQiOjM4LCJ2YWx1ZSI6Ik5VTEwifV19LHsibmFtZSI6ImJ3YSIsInR5cGUiOiJ3Iiwib2Zmc2V0IjoxOCwidmFsdWUiOjE2OTE2fV19LHsibmFtZSI6ImZvbyIsInR5cGUiOiJ4Iiwib2Zmc2V0IjoyMCwidmFsdWUiOjU3MzJ9XSxbeyJpbmRleCI6MSwib2Zmc2V0IjoyNH0seyJuYW1lIjoiYmxhaCIsInR5cGUiOiJ3Iiwib2Zmc2V0IjoyNCwidmFsdWUiOjB9LHsibmFtZSI6Im1laCIsInR5cGUiOiJ3Iiwib2Zmc2V0IjoyNiwidmFsdWUiOjB9LHsibmFtZSI6IkJ1aCIsInR5cGUiOiJwbG9wIiwib2Zmc2V0IjoyOCwidmFsdWUiOlt7Im5hbWUiOiJmaXJzdCIsInR5cGUiOiJpIiwib2Zmc2V0IjoyOCwidmFsdWUiOjB9LHsibmFtZSI6IkJvaCIsInR5cGUiOiJ0cm9sbCIsIm9mZnNldCI6MzIsInZhbHVlIjpbeyJuYW1lIjoiaW50ZWdlciIsInR5cGUiOiJpIiwib2Zmc2V0IjozMiwidmFsdWUiOjE2NjR9LHsibmFtZSI6IndvcmQiLCJ0eXBlIjoidyIsIm9mZnNldCI6MzYsInZhbHVlIjoxNjM4NH0seyJuYW1lIjoiQmFoIiwidHlwZSI6InRyb2xsKiIsIm9mZnNldCI6MzgsInZhbHVlIjoiTlVMTCJ9XX0seyJuYW1lIjoiYndhIiwidHlwZSI6InciLCJvZmZzZXQiOjQyLCJ2YWx1ZSI6MH1dfSx7Im5hbWUiOiJmb28iLCJ0eXBlIjoieCIsIm9mZnNldCI6NDQsInZhbHVlIjowfV1dCgo=
CMDS64=ZSBhc20uYml0cz0zMgp3eCAzNDEyODk2NzlhMDIwMDAwYTAwZjAwMDAyYTAwMzAwMDAwMDAxNDQyNjQxNgp3eCA4MDA2MDAwMDAwNDBAMHgyMAp3eCAxNDAwMDAwMDY0MTYyMDAwMDAwMEAweDMwCnBmLnRyb2xsIGl3Kj8gaW50ZWdlciB3b3JkICh0cm9sbClCYWgKcGYucGxvcCBpP3cgZmlyc3QgKHRyb2xsKUJvaCBid2EKcGYuZ29iZWxpbiAyd3c/eCBibGFoIG1laCAocGxvcClCdWggZm9vCnBmai5nb2JlbGluCgo=
RUN
NAME=access specific element through nested struct
FILE=malloc://1024
EXPECT64=ICBCdWggOiAKICAgICAgICAgICAgICAgIHN0cnVjdDxwbG9wPgogICAgICAgZmlyc3QgOiAweDAwMDAwMDA0ID0gNjY2CiAgQnVoIDogCiAgICAgICAgICAgICAgICBzdHJ1Y3Q8cGxvcD4KICAgICAgICAgQm9oIDogCiAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3Q8dHJvbGw+CiAgICAgICAgICAgICAgICAgICAgd29yZCA6IDB4MDAwMDAwMGMgPSAweDAwMmEKCg==
CMDS64=ZSBhc20uYml0cz0zMgp3eCAzNDEyODk2NzlhMDIwMDAwYTAwZjAwMDAyYTAwMzAwMDAwMDAxNDQyNjQxNgp3eCA4MDA2MDAwMDAwNDBAMHgyMAp3eCAxNDAwMDAwMDY0MTYyMDAwMDAwMEAweDMwCnBmLnRyb2xsIGl3Kj8gaW50ZWdlciB3b3JkICh0cm9sbClCYWgKcGYucGxvcCBpP3cgZmlyc3QgKHRyb2xsKUJvaCBid2EKcGYuZ29iZWxpbiB3dz94IGJsYWggbWVoIChwbG9wKUJ1aCBmb28KcGYuZ29iZWxpbi5CdWguZmlyc3QKcGYuZ29iZWxpbi5CdWguQm9oLndvcmQKCg==
RUN
NAME=access specific element in an array
FILE=malloc://1024
EXPECT64=IHN0ciA6IApbCiAgICAgICAgICAgICAgICBzdHJ1Y3Q8cGxvcD4KICAgICAgICAgb25lIDogMHgwMDAwMDAxMCA9IDQwMDAKICAgICAgICAgdHdvIDogMHgwMDAwMDAxNCA9IDB4ZGVhZAogICAgICAgdGhyZWUgOiAweDAwMDAwMDE2ID0gKHF3b3JkKTB4MDAwMDAwMDAwMDAwMDAwMAogICAgICAgIGZvdXIgOiAweDAwMDAwMDFlID0gMHgwMDAwCl0KIHN0ciA6IApbCiAgICAgICAgICAgICAgICBzdHJ1Y3Q8cGxvcD4KICAgICAgICAgdHdvIDogMHgwMDAwMDAxNCA9IDB4ZGVhZApdCgo=
CMDS64=ZSBhc20uYml0cz0zMgp3eCBhMDBmMDAwMGFkZGUgQCAweDEwCnBmLnBsb3AgaXdxdyBvbmUgdHdvIHRocmVlIGZvdXIKcGYudHJvbGwgWzNdPyAocGxvcClzdHIKcGYudHJvbGwuc3RyWzFdCnBmLnRyb2xsLnN0clsxXS50d28KCg==
RUN
NAME=Complex request with specific array element and specific field
FILE=../bins/pe/ch22.exe
EXPECT64=ICAgICAgZV9yZXMgOiAweDAwMDAwMGEwID0gWyAweDM0MDAgXQogICAgIGVfcmVzMiA6IDB4MDAwMDAwYjggPSBbIDB4MjAwMCBdCgo=
ARGS=-nn
CMDS64=ZSBhc20uYml0cz0zMgpzIDB4ODAKcGYucGVfZG9zX2hlYWRlci5lX3Jlc1syXQpwZi5wZV9kb3NfaGVhZGVyLmVfcmVzMls4XQoK
RUN
NAME=write specific element through nested struct
FILE=malloc://1024
EXPECT64=d3Y0IDQyIEAgNAp3djIgMHhhZGRlIEAgMHgwMDAwMDAyNAogYmxhaCA6IDB4MDAwMDAwMDAgPSAweDEyMzQKICBtZWggOiAweDAwMDAwMDAyID0gMHg2Nzg5CiAgQnVoIDogCiAgICAgICAgICAgICAgICBzdHJ1Y3Q8cGxvcD4KICAgICAgIGZpcnN0IDogMHgwMDAwMDAwNCA9IDQyCiAgICAgICAgIEJvaCA6IAogICAgICAgICAgICAgICAgICAgICAgc3RydWN0PHRyb2xsPgogICAgICAgICAgICAgICAgIGludGVnZXIgOiAweDAwMDAwMDA4ID0gNDAwMAogICAgICAgICAgICAgICAgICAgIHdvcmQgOiAweDAwMDAwMDBjID0gMHgwMDJhCiAgICAgICAgICAgICAgICAgICAgIEJhaCA6ICgqMHgzMCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdDx0cm9sbD4KICAgICAgICAgICAgICAgICAgICAgICAgIGludGVnZXIgOiAweDAwMDAwMDMwID0gMjAKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdvcmQgOiAweDAwMDAwMDM0ID0gMHgxNjY0CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQmFoIDogKCoweDIwKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0PHRyb2xsPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnRlZ2VyIDogMHgwMDAwMDAyMCA9IDE2NjQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd29yZCA6IDB4MDAwMDAwMjQgPSAweGFkZGUKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEJhaCA6ICgqMHgwKSBOVUxMCiAgICAgICAgIGJ3YSA6IDB4MDAwMDAwMTIgPSAweDQyMTQKICBmb28gOiAweDAwMDAwMDE0ID0gMHgwMDAwMTY2NAo=
CMDS64=ZSBhc20uYml0cz0zMgp3eCAzNDEyODk2NzlhMDIwMDAwYTAwZjAwMDAyYTAwMzAwMDAwMDAxNDQyNjQxNgp3eCA4MDA2MDAwMDAwNDBAMHgyMAp3eCAxNDAwMDAwMDY0MTYyMDAwMDAwMEAweDMwCnBmLnRyb2xsIGl3Kj8gaW50ZWdlciB3b3JkICh0cm9sbClCYWgKcGYucGxvcCBpP3cgZmlyc3QgKHRyb2xsKUJvaCBid2EKcGYuZ29iZWxpbiB3dz94IGJsYWggbWVoIChwbG9wKUJ1aCBmb28KcGYuZ29iZWxpbi5CdWguZmlyc3Q9NDIKLnBmLmdvYmVsaW4uQnVoLmZpcnN0PTQyCnBmLmdvYmVsaW4uQnVoLkJvaC5CYWguQmFoLndvcmQ9MHhhZGRlCi5wZi5nb2JlbGluLkJ1aC5Cb2guQmFoLkJhaC53b3JkPTB4YWRkZQpwZi5nb2JlbGluCgo=
RUN
NAME=print anonymous nested struct
FILE=malloc://1024
EXPECT64=IGEgOiAweDAwMDAwMDAwID0gMTkxOTI1MjMzNwogYiA6IDB4MDAwMDAwMDQgPSAndCcKIGMgOiAKICAgICAgICAgICAgICAgIHN0cnVjdDxpP2kgYSAoZHNmKWIgYz4KICAgYSA6IDB4MDAwMDAwMDggPSAxOTM1NzY1NjE1CiAgIGIgOiAKICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdDxkc2Y+CiAgICAgYSA6IDB4MDAwMDAwMGMgPSAxNzUxNjA2ODg0CiAgICAgYiA6IDB4MDAwMDAwMTAgPSAyMDUzOTI1NzM4CiAgIGMgOiAweDAwMDAwMDE0ID0gMTY1MTkyNTg4MAogZCA6IDB4MDAwMDAwMTggPSAyMDAzOTIyMjg2CiBhIDogMHgwMDAwMDAwMCA9IDE5MTkyNTIzMzcKIGIgOiAweDAwMDAwMDA0ID0gJ3QnCiBjIDogKCoweDczNjE3MDZmKQogICAgICAgICAgICAgICAgc3RydWN0PGk/aSBhIChkc2YpYiBjPgogICBhIDogMHg3MzYxNzA2ZiA9IC0xCiAgIGIgOiAKICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdDxkc2Y+CiAgICAgYSA6IDB4NzM2MTcwNzMgPSAtMQogICAgIGIgOiAweDczNjE3MDc3ID0gLTEKICAgYyA6IDB4NzM2MTcwN2IgPSAtMQogZCA6IDB4MDAwMDAwMGMgPSAxNzUxNjA2ODg0Cg==
CMDS64=ZSBhc20uYml0cz0zMgp3eCA3MTc3NjU3Mjc0Nzk3NTY5NmY3MDYxNzM2NDY2Njc2ODZhNmI2YzdhNzg2Mzc2NjI2ZTZkNzE3NzY1NzI3NDc5NzU2OTZmNzA2MTczNjQ2NjY3Njg2YTZiNmM3YTc4NjM3NjYyNmU2ZApwZi5kc2YgaWkgYSBiCnBmLmFiYyBpYy4uLj9pIGEgYiAocGYgaT9pIGEgKGRzZiliIGMpYyBkCnBmLmRlZiBpYy4uLio/aSBhIGIgKHBmIGk/aSBhIChkc2YpYiBjKWMgZApwZi5hYmMKcGYuZGVmCg==
RUN
NAME=pf only one size
FILE=malloc://1024
EXPECT64=VXNhZ2U6IHBmIFswfGNudF1bZm9ybWF0LXN0cmluZ10KCg==
CMDS64=CnBmIDE2IDE2Cgo=
RUN
NAME=pf refuse space between size and format-string
FILE=malloc://1024
EXPECT64=VXNhZ2U6IHBmIFswfGNudF1bZm9ybWF0LXN0cmluZ10KCg==
CMDS64=CnBmIDE2IDE2Cgo=
RUN
NAME=pf field name
FILE=malloc://1024
EXPECT64=MHgwMDAwMDAwMCBbMF0gewogICB4MiA6IDB4MDAwMDAwMDAgPSAweDAwMDAwMDAwCn0KMHgwMDAwMDAwNCBbMV0gewogICB4MiA6IDB4MDAwMDAwMDQgPSAweDAwMDAwMDAwCn0KCg==
CMDS64=cGYgMnggeDIKCg==
RUN
NAME=pf rop64
FILE=malloc://1024
EXPECT64=KCoweDIyKXB1c2ggcmJwCigqMHgyMylwb3AgcmF4Cg==
CMDS64=ZSBhc20uYml0cz02NAp3eCA1NTU4IEAgMHgyMgp3djggMHgyMiBAIDB4NTAKd3Y4IDB4MjMgQCAweDU4CnBmICpEKkQgQCAweDUwCg==
RUN
NAME=pf rop32
FILE=malloc://1024
EXPECT64=KCoweDIyKXB1c2ggZWJwCigqMHgyMylwb3AgZWF4Cg==
CMDS64=ZSBhc20uYml0cz0zMgp3eCA1NTU4IEAgMHgyMgp3djQgMHgyMiBAIDB4NTAKd3Y0IDB4MjMgQCAweDU0CnBmICpEKkQgQCAweDUwCg==
RUN
NAME=pf *z (64bit addr)
FILE=-
CMDS=<<EXPECT
e io.cache=true
e asm.bits=64
wz root @ 0x0000000100000faf
pf z @ 0x0000000100000faf
e cfg.bigendian=false
16wxs cc @ 0x200
wv8 0x0000000100000faf @ 0x204
pf *z @ 0x204
e cfg.bigendian=true
16wxs cc @ 0x200
wv8 0x0000000100000faf @ 0x204
pf *z @ 0x204
EXPECT=<<RUN
0x100000faf = root
(*0x100000faf)0x00000204 = root
(*0x100000faf)0x00000204 = root
RUN
